<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ログイン</title>
    <script src="js/jquery-3.6.3.min.js"></script>
    <script src="js/jquery.cookie-1.4.1.min.js"></script>
    <link rel="stylesheet" href="css/base.css">
</head>
<body>
<form action="">
    <div id="loginContainer">
        <h2>ログイン</h2>
        <div class="marginGap">
            <label for="userId">
                ユーザー名
            </label>
            <input id="userId" type="text" class="marginLeft">

        </div>
        <div class="marginGap">
            <label for="password">
                パスワード
            </label>
            <input id="password" type="password" class="marginLeft">
        </div>
        <div class="marginGap">
            <input type="button" value="送信">
        </div>
    </div>
</form>
</body>
<script>
    $(":button").click(function() {
        $.ajax({
            contentType:"application/json",
            dataType: "json",
            type: "POST",
            headers:{

                        userId: $("#userId").val(),
                        password:$("#password").val()

            },
            url:"/device/login?"+$.param({
                userId: $("#userId").val(),
                password:$("#password").val()
            }),
            // url:"https://eopz8ly41cg8q6s.m.pipedream.net",
            data:
                {
                    data:
                        {
                            userId: $("#userId").val(),
                            password:$("#password").val()
                        }
                },
            success:function (data) {
                if (data && !data.ret && !isNaN(data.ret)) {
                    $.cookie("loginState",true,10*60*24)
                    window.location.href = "index.html";
                }else {
                    alert("ログイン失敗！"+data.msg);
                }
            },
            error:function (data) {
                alert("ログイン失敗！"+data.msg)
            }
        })


        /*if ($("#userId").val()=="admin"&&$("#password").val()=="admin"){
            if ($.cookie("loginState",true,10/60/24)){
                window.location.href="index.html";
            }
        }else{
            alert("ログイン失敗！")
        }*/
    })
</script>
</html>